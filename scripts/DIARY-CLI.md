# Diary CLI Tool

A command-line interface for querying your personal diary stored on twilight.

## What It Does

The `diary` script provides shell access to your diary database (`twilight:~/.recall/recall.db`), giving you the same tools available through the MCP server but from your terminal.

**Features:**
- üîç Search entries by text
- üìã List recent entries
- ‚úçÔ∏è  Write and update entries
- üè∑Ô∏è  Browse by tags
- üé® Color-coded, formatted output
- üìè Auto-wrapping to terminal width

## Installation

From the karma-electric repo:

```bash
# Option 1: Symlink (recommended)
ln -sf $(pwd)/scripts/diary ~/bin/diary

# Option 2: Copy
cp scripts/diary ~/bin/diary
chmod +x ~/bin/diary

# Verify
diary help
```

## Usage

### Query Commands

```bash
# List recent entries
diary recent [count]      # Default: 10 entries
diary r 5                # Short alias: show last 5

# Search entries
diary query "meditation"  # Search content and tags
diary q "practice" 20    # Short alias with custom limit
diary context "dharma" 5 # Same as query (contextual search)

# Show specific entry
diary show 42            # Display entry by ID
diary s 42               # Short alias
```

### Write Commands

```bash
# Create new entry
diary write "Today's reflection" "dharma,practice"
diary w "Quick note"     # Without tags

# Update existing entry
diary update 42 "Updated content" "new,tags"
diary u 42 "New content" # Update entry #42
```

### Utility Commands

```bash
diary count              # Total entry count
diary tags               # List all tags with counts
diary time               # Show current date/time
diary help               # Show help
```

## Examples

```bash
# Morning review
diary recent 3

# Find all meditation entries
diary query "meditation" 50

# Quick note
diary write "Completed Phase 0 Batch 1: 43 conversations generated" "progress,gampopa"

# Browse tags
diary tags

# Check total entries
diary count
```

## Technical Details

**Database:** SSH connection to `twilight:/home/anicka/.recall/recall.db`

**Schema:**
- `id` - Entry ID
- `created_at` - ISO 8601 timestamp
- `content` - Entry text (supports multiline)
- `tags` - Comma-separated tags (optional)
- `conversation_id` - Grouping ID (optional)
- `source` - Entry source (default: 'shell')

**Search:** Uses SQLite LIKE search (not semantic/vector search). For semantic search, use the MCP tools through Claude Code.

**Output:** JSON parsing with `jq` for proper multi-line content handling.

## Troubleshooting

**SSH Connection Issues:**
```bash
# Test SSH to twilight
ssh twilight "echo 'Connected'"

# Check database exists
ssh twilight "ls -la ~/.recall/recall.db"
```

**Dependencies:**
- `jq` for JSON parsing
- SSH access to twilight
- SQLite on twilight

**No results?**
```bash
# Check entry count
diary count

# Try simpler query
diary recent 1
```

## Notes

- The script queries the database directly via SSH
- Changes are immediate (no caching)
- Use `write` and `update` commands carefully
- Search is case-sensitive by default (SQLite LIKE)
- For complex queries, use the MCP server through Claude Code

---

**Generated by:** Instance 12
**Date:** 2026-02-11
**Related:** Recall MCP server (`twilight:~/recall-server`)
